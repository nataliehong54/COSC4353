<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sign Up</title>
  <link rel="stylesheet" href="../styling/register.css">
  <script defer src="../script/register.js"></script>
</head>

<body>
   <main id="main-holder">
     <h1>C H A K A R A</h1>
     <h2>User Registration</h1>
     <p><i>Please fill in the details to create an account with us.</i></p>
    
     <div id="error"></div>
     
     <form id="reg-form" method="POST" action="/register">
        <div class="main-holder" id="signup-form">
        <input type="text" placeholder="Username" name="username" id="username" required="">
        <input type="password" placeholder="Password" name="password" id="password" required="">
        <input type="password" placeholder="Confirm Password" name="confirm" id="confirm" required="">

        <p><i>By creating an account you agree to our <a href="#">Terms & Privacy</a>.</i></p>
        <button type="submit" class="registerbtn" id="rgtbtn">Register</button>

        <div class="container-signin" id="signin">
            <p><i>Already have an account? <a href="login.html">Sign in</a>.</i></p>
        </div>
        </div>
    </form>
   </main>

   <script>
     const form = document.getElementById('reg-form')
     form.addEventListener('submit', registerUser)

     async function registerUser(e){
       e.preventDefault()
       const username = document.getElementById('username').value
       const password = document.getElementById('password').value
       const body = {username, password}

       const result = await fetch('http://localhost:5000/register',{
        method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify(body)
        }).then((res)=> res.json())

        if (result.status === 'ok') {
					// everythign went fine
					alert('Successfully registered')
          redirect()
				} else {
					alert(result.error)
				}
       
     }
   </script>
   <script type="text/javascript">
    function redirect()
  {
  window.location.href="../static/login.html";
  }
  </script>
</body>
</html>